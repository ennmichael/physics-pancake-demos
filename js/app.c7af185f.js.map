{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?803f","webpack:///./src/components/DemoChoice.vue?4257","webpack:///./src/components/mass-aggregate/ParticleDemo.vue?ba73","webpack:///./src/engine/Simulation.js","webpack:///./src/NotImplemented.js","webpack:///src/components/Demo.vue","webpack:///./src/components/Demo.vue","webpack:///./src/components/Demo.vue?9a6b","webpack:///./src/components/GravitySlider.vue?b57e","webpack:///src/components/GravitySlider.vue","webpack:///./src/components/GravitySlider.vue?aa05","webpack:///./src/components/GravitySlider.vue","webpack:///./src/components/RestartButton.vue?e386","webpack:///./src/components/RestartButton.vue","webpack:///./src/components/InteractiveSimulationDisplay.vue?561f","webpack:///./src/utils.js","webpack:///./src/Vector.js","webpack:///./src/components/SimulationDisplay.vue?e719","webpack:///./src/graphics.js","webpack:///src/components/SimulationDisplay.vue","webpack:///./src/components/SimulationDisplay.vue?b425","webpack:///./src/components/SimulationDisplay.vue","webpack:///src/components/InteractiveSimulationDisplay.vue","webpack:///./src/components/InteractiveSimulationDisplay.vue?fcf4","webpack:///./src/components/InteractiveSimulationDisplay.vue","webpack:///./src/engine/Engine.js","webpack:///./src/engine/mass-aggregate/Particle.js","webpack:///./src/engine/mass-aggregate/Contact.js","webpack:///./src/engine/mass-aggregate/ParticleContact.js","webpack:///./src/engine/mass-aggregate/TerrainContact.js","webpack:///./src/engine/mass-aggregate/MassAggregateEngine.js","webpack:///./src/Line.js","webpack:///./src/engine/mass-aggregate/MassAggregateDrawing.js","webpack:///src/components/mass-aggregate/ParticleDemo.vue","webpack:///./src/components/mass-aggregate/ParticleDemo.vue?9e31","webpack:///./src/components/mass-aggregate/ParticleDemo.vue","webpack:///./src/components/mass-aggregate/SpringDemo.vue?1d77","webpack:///./src/components/StiffnessSlider.vue?cbe9","webpack:///src/components/StiffnessSlider.vue","webpack:///./src/components/StiffnessSlider.vue?8c8b","webpack:///./src/components/StiffnessSlider.vue","webpack:///./src/engine/mass-aggregate/Spring.js","webpack:///src/components/mass-aggregate/SpringDemo.vue","webpack:///./src/components/mass-aggregate/SpringDemo.vue?0c07","webpack:///./src/components/mass-aggregate/SpringDemo.vue","webpack:///./src/components/mass-aggregate/TerrainDemo.vue?0fc1","webpack:///./src/components/RestitutionSlider.vue?5c29","webpack:///src/components/RestitutionSlider.vue","webpack:///./src/components/RestitutionSlider.vue?26bb","webpack:///./src/components/RestitutionSlider.vue","webpack:///./src/components/AngleSlider.vue?06cd","webpack:///src/components/AngleSlider.vue","webpack:///./src/components/AngleSlider.vue?5e1e","webpack:///./src/components/AngleSlider.vue","webpack:///./src/components/LengthSlider.vue?7169","webpack:///src/components/LengthSlider.vue","webpack:///./src/components/LengthSlider.vue?460f","webpack:///./src/components/LengthSlider.vue","webpack:///./src/Polygon.js","webpack:///./src/engine/mass-aggregate/TerrainElement.js","webpack:///src/components/mass-aggregate/TerrainDemo.vue","webpack:///./src/components/mass-aggregate/TerrainDemo.vue?6d9e","webpack:///./src/components/mass-aggregate/TerrainDemo.vue","webpack:///./src/components/mass-aggregate/ParticleCollisionDemo.vue?e121","webpack:///./src/components/ParticleMassSliders.vue?9aca","webpack:///src/components/ParticleMassSliders.vue","webpack:///./src/components/ParticleMassSliders.vue?51ad","webpack:///./src/components/ParticleMassSliders.vue","webpack:///src/components/mass-aggregate/ParticleCollisionDemo.vue","webpack:///./src/components/mass-aggregate/ParticleCollisionDemo.vue?0b2e","webpack:///./src/components/mass-aggregate/ParticleCollisionDemo.vue","webpack:///src/components/DemoChoice.vue","webpack:///./src/components/DemoChoice.vue?1660","webpack:///./src/components/DemoChoice.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_h","$createElement","_c","_self","staticRenderFns","DemoChoicevue_type_template_id_693e95c4_render","directives","rawName","expression","on","change","$event","$$selectedVal","Array","filter","target","options","selected","map","val","_value","currentDemo","multiple","_l","demo","title","domProps","component","_v","_s","tag","DemoChoicevue_type_template_id_693e95c4_staticRenderFns","ParticleDemovue_type_template_id_f204f8a6_render","attrs","simulation","click","restartEngine","engine","ParticleDemovue_type_template_id_f204f8a6_staticRenderFns","Simulation","constructor","drawing","redraw","integrateTime","time","NotImplemented","Error","Demo_render","Demo_staticRenderFns","Demovue_type_script_lang_js_","[object Object]","undefined","createEngine","createDrawing","context","document","getElementsByTagName","getContext","methods","previousEngine","components_Demovue_type_script_lang_js_","componentNormalizer","__file","Demo","GravitySlidervue_type_template_id_2d52b358_render","for","modifiers","number","id","type","min","max","step","__r","$set","_n","blur","$forceUpdate","GravitySlidervue_type_template_id_2d52b358_staticRenderFns","GravitySlidervue_type_script_lang_js_","props","components_GravitySlidervue_type_script_lang_js_","GravitySlider_component","GravitySlider","RestartButtonvue_type_template_id_f7052c56_render","_g","$listeners","RestartButtonvue_type_template_id_f7052c56_staticRenderFns","script","RestartButton_component","RestartButton","InteractiveSimulationDisplayvue_type_template_id_2c664f06_render","mousemove","onMouseMove","mouseup","onMouseUp","mousedown","onMouseDown","mouseleave","onMouseLeave","InteractiveSimulationDisplayvue_type_template_id_2c664f06_staticRenderFns","epsilon","sequence","x","minKey","elem","k","almostEquals","a","b","Math","abs","valueIsBetween","limits","minLimit","maxLimit","Vector","zero","y","reset","normal","positiveDirection","normalized","dot","negated","flippedTowards","direction","cloned","magnitude","sqrt","magnitudeSquared","scaled","isNormalized","other","cross","added","subtracted","factor","add","subtract","scale","distanceSquared","distance","projected","SimulationDisplayvue_type_template_id_1fa9a6fa_render","width","height","reEmit","$emit","SimulationDisplayvue_type_template_id_1fa9a6fa_staticRenderFns","clearContext","style","fillStyle","fillRect","canvas","drawCircle","position","radius","beginPath","fromNormalizedDeviceCoordinates","xRadius","yRadius","ellipse","PI","fill","drawLine","line","strokeStyle","origin","moveTo","end","lineTo","stroke","drawPolygon","polygon","edgesAreConnected","points","edges","edge","point","coordinates","toNormalizedDeviceCoordinates","SimulationDisplayvue_type_script_lang_js_","frameCallback","requestAnimationFrame","eventName","event","clickPosition","left","top","getBoundingClientRect","Vector_Vector","clientX","clientY","components_SimulationDisplayvue_type_script_lang_js_","SimulationDisplay_component","SimulationDisplay","minSelectionDistance","minSelectionDistanceSquared","particleThrowMultiplier","InteractiveSimulationDisplayvue_type_script_lang_js_","components","selection","particle","wasFixed","previousPosition","mousePosition","velocity","fixed","throwSelectedParticle","newlySelectedParticle","delta","console","log","particles","selectionDistance","components_InteractiveSimulationDisplayvue_type_script_lang_js_","InteractiveSimulationDisplay_component","InteractiveSimulationDisplay","Engine","timestep","timeAccumulator","lastIntegrationTime","currentTime","integrateStep","baseRadius","Particle","mass","gravityScale","fixedRadius","force","applyGravity","gravity","update","damping","updateVelocity","applyDamping","updatePosition","overlaps","radiiSum","speed","speedSquared","pow","acceleration","Contact","solve","ParticleContact","super","solveInterpenetration","solveBounce","interpenetration","netSpeed","netMass","minimumBounceSpeed","minimumBounceSpeedSquared","TerrainContact","terrainElement","penetrationDepth","removePenetration","bounceParticle","slideParticle","applyFriction","offset","friction","normalVelocity","restitution","closestEdge","positionBound","positionWithinBounds","MassAggregateEngine","defaultTimestep","springs","terrain","clearUselessParticles","resetForces","updateSprings","solveContacts","updateParticles","contact","findContacts","findParticleContacts","findTerrainContacts","otherParticle","containsPoint","spring","Line","TypeError","rayIntersects","u","intersectionParameters","intersects","intersection","div","closestPoint","opposite","lengthSquared","visualForceScale","backgroundStyle","particleColor","hue","saturation","lightness","maxColorHue","springStyle","terrainStyle","forceStyle","MassAggregateDrawing","drawingForces","drawingTerrain","drawingSprings","drawingParticles","clear","drawTerrain","drawParticles","drawSprings","drawForces","currentHue","hueStep","ParticleDemovue_type_script_lang_js_","mixins","MassAggregateEngine_MassAggregateEngine","Particle_Particle","MassAggregateDrawing_MassAggregateDrawing","mass_aggregate_ParticleDemovue_type_script_lang_js_","ParticleDemo_component","ParticleDemo","SpringDemovue_type_template_id_47609f19_render","model","callback","$$v","stiffness","SpringDemovue_type_template_id_47609f19_staticRenderFns","StiffnessSlidervue_type_template_id_ebf97798_render","input","Number","StiffnessSlidervue_type_template_id_ebf97798_staticRenderFns","StiffnessSlidervue_type_script_lang_js_","components_StiffnessSlidervue_type_script_lang_js_","StiffnessSlider_component","StiffnessSlider","Spring","restingLength","currentLength","contract","fromParticle","toParticle","contractionMagnitude","lengthDelta","SpringDemovue_type_script_lang_js_","watch","newStiffness","Spring_Spring","mass_aggregate_SpringDemovue_type_script_lang_js_","SpringDemo_component","SpringDemo","TerrainDemovue_type_template_id_da9b0c44_render","platform","platformAngle","platformLength","TerrainDemovue_type_template_id_da9b0c44_staticRenderFns","RestitutionSlidervue_type_template_id_b516d652_render","RestitutionSlidervue_type_template_id_b516d652_staticRenderFns","RestitutionSlidervue_type_script_lang_js_","components_RestitutionSlidervue_type_script_lang_js_","RestitutionSlider_component","RestitutionSlider","AngleSlidervue_type_template_id_d568e0de_render","AngleSlidervue_type_template_id_d568e0de_staticRenderFns","AngleSlidervue_type_script_lang_js_","components_AngleSlidervue_type_script_lang_js_","AngleSlider_component","AngleSlider","LengthSlidervue_type_template_id_20570698_render","LengthSlidervue_type_template_id_20570698_staticRenderFns","LengthSlidervue_type_script_lang_js_","components_LengthSlidervue_type_script_lang_js_","LengthSlider_component","LengthSlider","vertices","Polygon","fromEdges","from","ray","countIntersections","reduce","acc","TerrainElement","startingPosition","TerrainDemovue_type_script_lang_js_","platformRestitution","Polygon_Polygon","fromVertices","updatePlatformLayout","lengthHalf","cos","sin","mass_aggregate_TerrainDemovue_type_script_lang_js_","TerrainDemo_component","TerrainDemo","ParticleCollisionDemovue_type_template_id_a59cdcce_render","firingForce","ParticleCollisionDemovue_type_template_id_a59cdcce_staticRenderFns","ParticleMassSlidersvue_type_template_id_1055ef77_render","index","ParticleMassSlidersvue_type_template_id_1055ef77_staticRenderFns","ParticleMassSlidersvue_type_script_lang_js_","components_ParticleMassSlidersvue_type_script_lang_js_","ParticleMassSliders_component","ParticleMassSliders","leftParticlePosition","rightParticlePosition","ParticleCollisionDemovue_type_script_lang_js_FiredParticle","params","fired","ParticleCollisionDemovue_type_script_lang_js_","mass_aggregate_ParticleCollisionDemovue_type_script_lang_js_","ParticleCollisionDemo_component","ParticleCollisionDemo","DemoChoicevue_type_script_lang_js_","demos","components_DemoChoicevue_type_script_lang_js_","DemoChoice_component","DemoChoice","Appvue_type_script_lang_js_","src_Appvue_type_script_lang_js_","App_component","App","Vue","config","productionTip","el","h"],"mappings":"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","file":"js/app.c7af185f.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('DemoChoice')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.currentDemo),expression:\"currentDemo\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.currentDemo=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.demos),function(demo){return _c('option',{key:demo.title,domProps:{\"value\":demo.component}},[_vm._v(\"\\n      \"+_vm._s(demo.title)+\"\\n    \")])}),0),_c(_vm.currentDemo,{tag:\"component\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tbody',[_c('tr',[_c('td',[_c('InteractiveSimulationDisplay',{attrs:{\"simulation\":_vm.simulation}})],1)]),_c('tr',[_c('td',[_c('RestartButton',{on:{\"click\":_vm.restartEngine}})],1)]),_c('tr',[_c('td',[_c('GravitySlider',{attrs:{\"engine\":_vm.simulation.engine}})],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class Simulation {\r\n    constructor({ drawing, engine }) {\r\n        this.engine = engine;\r\n        this.drawing = drawing;\r\n    }\r\n\r\n    redraw() {\r\n        this.drawing.redraw(this.engine);\r\n    }\r\n\r\n    integrateTime(time) {\r\n        this.engine.integrateTime(time);\r\n    }\r\n}\r\n","export default class NotImplemented extends Error {\r\n}\r\n","<script>\r\nimport Simulation from '../engine/Simulation';\r\nimport NotImplemented from '../NotImplemented';\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            simulation: undefined,\r\n        };\r\n    },\r\n    created() {\r\n        this.simulation = new Simulation({\r\n            engine: this.createEngine({}),\r\n            drawing: this.createDrawing(),\r\n        });\r\n    },\r\n    mounted() {\r\n        this.simulation.drawing.context = document.getElementsByTagName('canvas')[0].getContext('2d');\r\n    },\r\n    methods: {\r\n        createEngine(previousEngine) {\r\n            throw new NotImplemented();\r\n        },\r\n        createDrawing() {\r\n            // The created drawing can leave its context undefined.\r\n            // mounted() will set up the context properly.\r\n            throw new NotImplemented();\r\n        },\r\n        restartEngine() {\r\n            this.simulation.engine = this.createEngine(this.simulation.engine);\r\n        },\r\n    }\r\n};\r\n</script>\r\n","var render, staticRenderFns\nimport script from \"./Demo.vue?vue&type=script&lang=js&\"\nexport * from \"./Demo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"Demo.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Demo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Demo.vue?vue&type=script&lang=js&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"gravity-slider\"}},[_vm._v(\"\\n    Gravity\\n  \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.engine.gravity),expression:\"engine.gravity\",modifiers:{\"number\":true}}],attrs:{\"id\":\"gravity-slider\",\"type\":\"range\",\"min\":\"0\",\"max\":\"1e-5\",\"step\":\"1e-9\"},domProps:{\"value\":(_vm.engine.gravity)},on:{\"__r\":function($event){_vm.$set(_vm.engine, \"gravity\", _vm._n($event.target.value))},\"blur\":function($event){_vm.$forceUpdate()}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <label for=\"gravity-slider\">\r\n      Gravity\r\n    </label>\r\n    <input\r\n      id=\"gravity-slider\"\r\n      v-model.number=\"engine.gravity\"\r\n      type=\"range\"\r\n      min=\"0\"\r\n      max=\"1e-5\"\r\n      step=\"1e-9\"\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        engine: Object,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GravitySlider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GravitySlider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GravitySlider.vue?vue&type=template&id=2d52b358&\"\nimport script from \"./GravitySlider.vue?vue&type=script&lang=js&\"\nexport * from \"./GravitySlider.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"GravitySlider.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',_vm._g({},_vm.$listeners),[_vm._v(\"\\n  Restart\\n\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./RestartButton.vue?vue&type=template&id=f7052c56&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"RestartButton.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SimulationDisplay',{attrs:{\"simulation\":_vm.simulation},on:{\"mousemove\":_vm.onMouseMove,\"mouseup\":_vm.onMouseUp,\"mousedown\":_vm.onMouseDown,\"mouseleave\":_vm.onMouseLeave}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const epsilon = 1e-5;\r\n\r\nexport function min(sequence, key = x => x) {\r\n    let result;\r\n    let minKey;\r\n\r\n    for (const elem of sequence) {\r\n        const k = key(elem);\r\n        if (k === undefined)\r\n            continue;\r\n        if (result === undefined || minKey === undefined || k < minKey) {\r\n            result = elem;\r\n            minKey = k;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function almostEquals(a, b, x = epsilon) {\r\n    return Math.abs(a - b) <= x;\r\n}\r\n\r\nexport function valueIsBetween({ value, limits }) {\r\n    const minLimit = Math.min(...limits);\r\n    const maxLimit = Math.max(...limits);\r\n    return minLimit <= value && value <= maxLimit;\r\n}\r\n","import { almostEquals } from './utils';\r\n\r\nexport default class Vector {\r\n    static get zero() {\r\n        return new Vector(0, 0);\r\n    }\r\n\r\n    constructor(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    reset() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n    }\r\n\r\n    normal(positiveDirection) {\r\n        const normal = new Vector(-this.y, this.x).normalized;\r\n        if (normal.dot(positiveDirection) > 0)\r\n            return normal;\r\n        return normal.negated;\r\n    }\r\n\r\n    flippedTowards(direction) {\r\n        if (this.dot(direction) > 0)\r\n            return this.cloned;\r\n        return this.negated;\r\n    }\r\n\r\n    get cloned() {\r\n        return new Vector(this.x, this.y);\r\n    }\r\n\r\n    get magnitude() {\r\n        return Math.sqrt(this.magnitudeSquared);\r\n    }\r\n\r\n    get magnitudeSquared() {\r\n        return this.x * this.x + this.y * this.y;\r\n    }\r\n\r\n    get normalized() {\r\n        return this.scaled(1 / this.magnitude);\r\n    }\r\n\r\n    get negated() {\r\n        return new Vector(-this.x, -this.y);\r\n    }\r\n\r\n    get isNormalized() {\r\n        return almostEquals(this.magnitudeSquared, 1);\r\n    }\r\n\r\n    almostEquals(other) {\r\n        return almostEquals(this.x, other.x) && almostEquals(this.y, other.y);\r\n    }\r\n\r\n    dot(other) {\r\n        return this.x * other.x + this.y * other.y;\r\n    }\r\n\r\n    cross(other) {\r\n        return this.x * other.y - this.y * other.x;\r\n    }\r\n\r\n    added(other) {\r\n        return new Vector(this.x + other.x, this.y + other.y);\r\n    }\r\n\r\n    subtracted(other) {\r\n        return new Vector(this.x - other.x, this.y - other.y);\r\n    }\r\n\r\n    scaled(factor) {\r\n        return new Vector(this.x * factor, this.y * factor);\r\n    }\r\n\r\n    add(other) {\r\n        this.x += other.x;\r\n        this.y += other.y;\r\n    }\r\n\r\n    subtract(other) {\r\n        this.x -= other.x;\r\n        this.y -= other.y;\r\n    }\r\n\r\n    scale(factor) {\r\n        this.x *= factor;\r\n        this.y *= factor;\r\n    }\r\n\r\n    distanceSquared(other) {\r\n        return this.subtracted(other).magnitudeSquared;\r\n    }\r\n\r\n    distance(other) {\r\n        return Math.sqrt(this.distanceSquared(other));\r\n    }\r\n\r\n    direction(other) {\r\n        return other.subtracted(this).normalized;\r\n    }\r\n\r\n    projected(other) {\r\n        if (!other.isNormalized)\r\n            other = other.normalized;\r\n        return other.normalized.scaled(this.dot(other));\r\n    }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{attrs:{\"width\":\"500\",\"height\":\"500\"},on:{\"mousemove\":function($event){_vm.reEmit('mousemove', $event)},\"mousedown\":function($event){_vm.reEmit('mousedown', $event)},\"mouseup\":function($event){_vm.reEmit('mouseup', $event)},\"mouseleave\":function($event){_vm.$emit('mouseleave')}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vector from './Vector';\r\n\r\nexport function clearContext(context, style) {\r\n    if (style)\r\n        context.fillStyle = style;\r\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\r\n}\r\n\r\nexport function drawCircle(context, { position, radius }, style) {\r\n    if (style)\r\n        context.fillStyle = style;\r\n    context.beginPath();\r\n    position = fromNormalizedDeviceCoordinates(position, context.canvas);\r\n    const xRadius = context.canvas.width * radius;\r\n    const yRadius = context.canvas.height * radius;\r\n    context.ellipse(position.x, position.y, xRadius, yRadius, 0, 0, Math.PI * 2);\r\n    context.fill();\r\n}\r\n\r\nexport function drawLine(context, line, style) {\r\n    if (style)\r\n        context.strokeStyle = style;\r\n    context.beginPath();\r\n    const origin = fromNormalizedDeviceCoordinates(line.origin, context.canvas);\r\n    context.moveTo(origin.x, origin.y);\r\n    const end = fromNormalizedDeviceCoordinates(line.end, context.canvas);\r\n    context.lineTo(end.x, end.y);\r\n    context.stroke();\r\n}\r\n\r\nexport function drawPolygon(context, polygon, style) {\r\n    if (style)\r\n        context.fillStyle = style;\r\n\r\n    if (!polygon.edgesAreConnected())\r\n        throw new Error('Disconnected polygon edges');\r\n\r\n    const points = polygon.edges.map(edge => fromNormalizedDeviceCoordinates(edge.origin, context.canvas));\r\n    context.beginPath();\r\n    context.moveTo(points[0].x, points[0].y);\r\n    for (const point of points.slice(1))\r\n        context.lineTo(point.x, point.y);\r\n    context.fill();\r\n}\r\n\r\nexport function fromNormalizedDeviceCoordinates(coordinates, { width, height }) {\r\n    const factor = coordinates.added(new Vector(1, 1)).scaled(0.5);\r\n    return new Vector(\r\n        width * factor.x,\r\n        height * (1 - factor.y),\r\n    );\r\n}\r\n\r\nexport function toNormalizedDeviceCoordinates(coordinates, { width, height }) {\r\n    const factor = new Vector(coordinates.x / width, 1 - coordinates.y / height);\r\n    return factor.added(new Vector(-0.5, -0.5)).scaled(2);\r\n}\r\n","<template>\r\n  <canvas\r\n    width=\"500\"\r\n    height=\"500\"\r\n    @mousemove=\"reEmit('mousemove', $event)\"\r\n    @mousedown=\"reEmit('mousedown', $event)\"\r\n    @mouseup=\"reEmit('mouseup', $event)\"\r\n    @mouseleave=\"$emit('mouseleave')\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport { toNormalizedDeviceCoordinates } from '../graphics';\r\nimport Vector from '../Vector';\r\n\r\nexport default {\r\n    props: {\r\n        simulation: Object,\r\n    },\r\n    mounted() {\r\n        const frameCallback = time => {\r\n            this.simulation.integrateTime(time);\r\n            this.simulation.redraw();\r\n            requestAnimationFrame(frameCallback);\r\n        };\r\n\r\n        requestAnimationFrame(frameCallback);\r\n    },\r\n    methods: {\r\n        reEmit(eventName, event) {\r\n            const { canvas } = this.simulation.drawing.context;\r\n            this.$emit(eventName, toNormalizedDeviceCoordinates(this.clickPosition(event), canvas));\r\n        },\r\n        clickPosition(event) {\r\n            const { canvas } = this.simulation.drawing.context;\r\n            const { left, top } = canvas.getBoundingClientRect();\r\n            return new Vector(event.clientX - left, event.clientY - top);\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimulationDisplay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimulationDisplay.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SimulationDisplay.vue?vue&type=template&id=1fa9a6fa&\"\nimport script from \"./SimulationDisplay.vue?vue&type=script&lang=js&\"\nexport * from \"./SimulationDisplay.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"SimulationDisplay.vue\"\nexport default component.exports","<template>\r\n  <SimulationDisplay\r\n    :simulation=\"simulation\"\r\n    @mousemove=\"onMouseMove\"\r\n    @mouseup=\"onMouseUp\"\r\n    @mousedown=\"onMouseDown\"\r\n    @mouseleave=\"onMouseLeave\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport Vector from '../Vector';\r\nimport { min } from '../utils';\r\nimport SimulationDisplay from './SimulationDisplay';\r\n\r\nconst minSelectionDistance = 8e-2;\r\n\r\nconst minSelectionDistanceSquared = minSelectionDistance * minSelectionDistance;\r\n\r\nconst particleThrowMultiplier = 5e-2;\r\n\r\nexport default {\r\n    components: { SimulationDisplay },\r\n    props: {\r\n        simulation: Object,\r\n    },\r\n    data() {\r\n        return {\r\n            selection: {\r\n                particle: undefined,\r\n                wasFixed: undefined,\r\n            },\r\n            previousPosition: undefined,\r\n        };\r\n    },\r\n    methods: {\r\n        onMouseMove(mousePosition) {\r\n            if (this.selection.particle === undefined)\r\n                return;\r\n\r\n            this.previousPosition = this.selection.particle.position;\r\n            this.selection.particle.velocity = Vector.zero;\r\n            this.selection.particle.position = mousePosition;\r\n        },\r\n        onMouseUp(mousePosition) {\r\n            if (this.selection.particle === undefined)\r\n                return;\r\n\r\n            if (!this.selection.wasFixed) {\r\n                this.selection.particle.fixed = false;\r\n                this.throwSelectedParticle(mousePosition);\r\n            }\r\n\r\n            this.selection.particle = undefined;\r\n        },\r\n        onMouseDown(mousePosition) {\r\n            this.selection.particle = this.newlySelectedParticle(mousePosition);\r\n\r\n            if (this.selection.particle === undefined)\r\n                return;\r\n\r\n            this.selection.particle.position = mousePosition;\r\n            this.selection.wasFixed = this.selection.particle.fixed;\r\n            this.selection.particle.fixed = true;\r\n        },\r\n        onMouseLeave() {\r\n            if (this.selection.particle === undefined)\r\n                return;\r\n            if (!this.selection.wasFixed)\r\n                this.selection.particle.fixed = false;\r\n            this.selection.particle = undefined;\r\n        },\r\n        throwSelectedParticle() {\r\n            if (this.previousPosition === undefined)\r\n                return;\r\n\r\n            const delta = this.selection.particle.position.subtracted(this.previousPosition);\r\n            console.log(delta.x, delta.y);\r\n            this.selection.particle.velocity = delta.scaled(particleThrowMultiplier);\r\n        },\r\n        newlySelectedParticle(mousePosition) {\r\n            return min(this.simulation.engine.particles,\r\n                particle => {\r\n                    const selectionDistance = particle.position.distanceSquared(mousePosition);\r\n                    if (selectionDistance > minSelectionDistanceSquared)\r\n                        return undefined;\r\n                    return selectionDistance;\r\n                },\r\n            );\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractiveSimulationDisplay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InteractiveSimulationDisplay.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InteractiveSimulationDisplay.vue?vue&type=template&id=2c664f06&\"\nimport script from \"./InteractiveSimulationDisplay.vue?vue&type=script&lang=js&\"\nexport * from \"./InteractiveSimulationDisplay.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"InteractiveSimulationDisplay.vue\"\nexport default component.exports","import NotImplemented from '../NotImplemented';\r\n\r\n// XXX Perhaps in the future I should make it so that the engine (and the simulation) can be paused\r\n// During the pause, lastIntegrationTime gets updated, but timeAccumulator doesn't\r\n\r\nexport default class Engine {\r\n    static get timestep() {\r\n        return 1;\r\n    }\r\n\r\n    constructor() {\r\n        this.timeAccumulator = 0;\r\n        this.lastIntegrationTime = null;\r\n    }\r\n\r\n    integrateTime(currentTime) {\r\n        if (this.lastIntegrationTime === null) {\r\n            this.lastIntegrationTime = currentTime;\r\n            return;\r\n        }\r\n\r\n        this.timeAccumulator += currentTime - this.lastIntegrationTime;\r\n        this.lastIntegrationTime = currentTime;\r\n        while (this.timeAccumulator >= Engine.timestep) {\r\n            this.timeAccumulator -= Engine.timestep;\r\n            this.integrateStep();\r\n        }\r\n    }\r\n\r\n    integrateStep() {\r\n        throw new NotImplemented();\r\n    }\r\n}\r\n","import Engine from '../Engine';\r\nimport Vector from '../../Vector';\r\n\r\n// XXX\r\n// Something I'd like to add in the future is for particles\r\n// to also have a coeffcient of restitution and take that into account\r\n// when resolving contacts.\r\n//\r\n// For terrain contacts, adding the restitutions or calculating\r\n// an average value between the particle restitution and the\r\n// terrain restitution might work fine.\r\n//\r\n// For particle contacts, it's not as simple.\r\n// See https://en.wikipedia.org/wiki/Inelastic_collision#Formula\r\n// and also Kodicek D., Flynt J. P., Mathematics and Physics for Programmers,\r\n// chapter on collision resolution might be interesting.\r\n\r\nconst baseRadius = 6e-3;\r\n\r\nexport default class Particle {\r\n    constructor({ position, mass = 1, gravityScale = 1, fixedRadius = undefined, fixed = false }) {\r\n        this.position = position;\r\n        this.gravityScale = gravityScale;\r\n        this.force = Vector.zero;\r\n        this.velocity = Vector.zero;\r\n        this.mass = mass;\r\n        this.fixedRadius = fixedRadius;\r\n        this.fixed = fixed;\r\n    }\r\n\r\n    applyGravity(gravity) {\r\n        this.force.add(new Vector(0, -gravity * this.mass).scaled(this.gravityScale));\r\n    }\r\n\r\n    update(gravity, damping) {\r\n        if (this.fixed) {\r\n            this.velocity = Vector.zero;\r\n            return;\r\n        }\r\n\r\n        this.applyGravity(gravity);\r\n        this.updateVelocity();\r\n        this.applyDamping(damping);\r\n        this.updatePosition();\r\n    }\r\n\r\n    // XXX Test this\r\n    overlaps(other) {\r\n        const radiiSum = this.radius + other.radius;\r\n        return radiiSum * radiiSum > this.position.distanceSquared(other.position);\r\n    }\r\n\r\n    get radius() {\r\n        if (this.fixedRadius !== undefined)\r\n            return this.fixedRadius;\r\n        return baseRadius * Math.sqrt(this.mass);\r\n    }\r\n\r\n    get speed() {\r\n        return this.velocity.magnitude;\r\n    }\r\n\r\n    get speedSquared() {\r\n        return this.velocity.magnitudeSquared;\r\n    }\r\n\r\n    applyDamping(damping) {\r\n        this.velocity.scale(Math.pow(1 - damping, Engine.timestep));\r\n    }\r\n\r\n    updateVelocity() {\r\n        this.velocity.add(this.acceleration.scaled(Engine.timestep));\r\n    }\r\n\r\n    updatePosition() {\r\n        this.position.add(this.velocity.scaled(Engine.timestep));\r\n    }\r\n\r\n    get acceleration() {\r\n        return this.force.scaled(1 / this.mass);\r\n    }\r\n}\r\n","import NotImplemented from '../../NotImplemented';\r\n\r\nexport default class Contact {\r\n    solve() {\r\n        throw new NotImplemented();\r\n    }\r\n}\r\n","import Contact from './Contact';\r\n\r\nexport default class ParticleContact extends Contact {\r\n    constructor(particles) {\r\n        super();\r\n        this.particles = particles;\r\n    }\r\n\r\n    solve() {\r\n        this.solveInterpenetration();\r\n        this.solveBounce();\r\n    }\r\n\r\n    solveInterpenetration() {\r\n        const delta = this.normal.scaled(this.interpenetration / 2);\r\n        this.particles[0].position.subtract(delta);\r\n        this.particles[1].position.add(delta);\r\n    }\r\n\r\n    solveBounce() {\r\n        this.particles[0].velocity = this.normal.scaled(-this.particles[1].mass * this.netSpeed / this.netMass);\r\n        this.particles[1].velocity = this.normal.scaled(this.particles[0].mass * this.netSpeed / this.netMass);\r\n    }\r\n\r\n    get interpenetration() {\r\n        const distance = this.particles[0].position.distance(this.particles[1].position);\r\n        return this.particles[0].radius + this.particles[1].radius - distance;\r\n    }\r\n\r\n    get normal() {\r\n        return this.particles[0].position.direction(this.particles[1].position);\r\n    }\r\n\r\n    get netMass() {\r\n        return this.particles[0].mass + this.particles[1].mass;\r\n    }\r\n\r\n    get netSpeed() {\r\n        return this.particles[0].speed + this.particles[1].speed;\r\n    }\r\n}\r\n","import Contact from './Contact';\r\n\r\nconst minimumBounceSpeed = 1.3e-4;\r\n\r\nconst minimumBounceSpeedSquared = minimumBounceSpeed * minimumBounceSpeed;\r\n\r\nexport default class TerrainContact extends Contact {\r\n    constructor({ particle, terrainElement }) {\r\n        super();\r\n        this.particle = particle;\r\n        this.terrainElement = terrainElement;\r\n    }\r\n\r\n    solve() {\r\n        const edge = this.edge();\r\n        const normal = this.normal(edge);\r\n        const penetrationDepth = this.penetrationDepth(edge);\r\n\r\n        this.removePenetration(edge, normal, penetrationDepth);\r\n        if (this.bounceParticle(normal))\r\n            return;\r\n        this.slideParticle(edge, penetrationDepth);\r\n        this.applyFriction(edge);\r\n    }\r\n\r\n    removePenetration(edge, normal, penetrationDepth) {\r\n        this.particle.position.add(normal.scaled(penetrationDepth));\r\n    }\r\n\r\n    slideParticle(edge, penetrationDepth) {\r\n        const direction = edge.offset.flippedTowards(this.particle.velocity);\r\n        this.particle.velocity = this.particle.velocity.projected(direction);\r\n    }\r\n\r\n    applyFriction(edge) {\r\n        this.particle.velocity.scale(1 - this.terrainElement.friction);\r\n    }\r\n\r\n    bounceParticle(normal) {\r\n        if (this.particle.speedSquared < minimumBounceSpeedSquared)\r\n            return false;\r\n        const normalVelocity = this.particle.velocity.projected(normal);\r\n        this.particle.velocity.subtract(normalVelocity);\r\n        this.particle.velocity.add(normalVelocity.scaled(-this.terrainElement.restitution));\r\n        return true;\r\n    }\r\n\r\n    edge() {\r\n        return this.terrainElement.polygon.closestEdge(this.particle.position);\r\n    }\r\n\r\n    normal(edge) {\r\n        return edge.normal(this.particle.velocity.negated);\r\n    }\r\n\r\n    penetrationDepth(edge) {\r\n        return edge.distance(this.particle.position);\r\n    }\r\n}\r\n","import Engine from '../Engine';\r\nimport ParticleContact from './ParticleContact';\r\nimport TerrainContact from './TerrainContact';\r\n\r\nconst positionBound = 10;\r\n\r\nfunction positionWithinBounds({ x, y }) {\r\n    return (x >= -positionBound && x <= positionBound &&\r\n            y >= -positionBound && y <= positionBound);\r\n}\r\n\r\nexport default class MassAggregateEngine extends Engine {\r\n    static get defaultTimestep() {\r\n        // XXX This is way too low, set to 6\r\n        // that's about 3 updates per frame\r\n        // will need to tweak other values though\r\n        return 1;\r\n    }\r\n\r\n    constructor({\r\n        timestep = MassAggregateEngine.defaultTimestep,\r\n        gravity = 1e-6, damping = 7e-4,\r\n        particles = [], springs = [], terrain = []\r\n    } = {}) {\r\n        super(timestep);\r\n        this.gravity = gravity;\r\n        this.particles = particles;\r\n        this.springs = springs;\r\n        this.terrain = terrain;\r\n        this.damping = damping;\r\n    }\r\n\r\n    clearUselessParticles() {\r\n        this.particles = this.particles.filter(\r\n            particle => positionWithinBounds(particle.position));\r\n    }\r\n\r\n    integrateStep() {\r\n        this.resetForces();\r\n        this.updateSprings();\r\n        this.solveContacts();\r\n        this.updateParticles();\r\n        this.clearUselessParticles();\r\n\r\n        // clearUselessParticles doesn't strictly need to be called whenever we\r\n        // integrate, but I decided to call it here for simplicity.\r\n    }\r\n\r\n    solveContacts() {\r\n        for (const contact of this.findContacts())\r\n            contact.solve();\r\n    }\r\n\r\n    findContacts() {\r\n        return [\r\n            ...this.findParticleContacts(),\r\n            ...this.findTerrainContacts(),\r\n        ];\r\n    }\r\n\r\n    * findParticleContacts() {\r\n        for (let i = 0; i < this.particles.length - 1; ++i) {\r\n            const particle = this.particles[i];\r\n            for (const otherParticle of this.particles.slice(i + 1)) {\r\n                if (otherParticle.overlaps(particle))\r\n                    yield new ParticleContact([particle, otherParticle]);\r\n            }\r\n        }\r\n    }\r\n\r\n    * findTerrainContacts() {\r\n        for (const particle of this.particles) {\r\n            for (const terrainElement of this.terrain) {\r\n                if (terrainElement.polygon.containsPoint(particle.position))\r\n                    yield new TerrainContact({ particle, terrainElement });\r\n            }\r\n        }\r\n    }\r\n\r\n    resetForces() {\r\n        for (const particle of this.particles)\r\n            particle.force.reset();\r\n    }\r\n\r\n    updateSprings() {\r\n        for (const spring of this.springs)\r\n            spring.update(this.timestep);\r\n    }\r\n\r\n    updateParticles() {\r\n        for (const particle of this.particles)\r\n            particle.update(this.gravity, this.damping);\r\n    }\r\n}\r\n","import { epsilon, almostEquals, valueIsBetween } from './utils';\r\nimport Vector from './Vector';\r\n\r\nexport default class Line {\r\n    constructor({ origin, offset, end }) {\r\n        if (offset !== undefined && end !== undefined)\r\n            throw new TypeError('Either offset or end may be specified, but not both');\r\n\r\n        this.origin = origin.cloned;\r\n\r\n        if (end !== undefined)\r\n            this.end = end;\r\n        else if (offset !== undefined)\r\n            this.offset = offset;\r\n        else\r\n            throw new TypeError('Either offset or end must be specified');\r\n    }\r\n\r\n    normal(positiveDirection) {\r\n        return this.offset.normal(positiveDirection);\r\n    }\r\n\r\n    // Treats self as if it were a ray directed from origin into end\r\n    rayIntersects(other) {\r\n        const { t, u } = this.intersectionParameters(other);\r\n\r\n        if (t === undefined || u === undefined)\r\n            return false;\r\n\r\n        return -epsilon < t && -epsilon < u && u < 1 + epsilon;\r\n    }\r\n\r\n    intersects(other) {\r\n        const { t, u } = this.intersectionParameters(other);\r\n\r\n        if (t === undefined || u === undefined)\r\n            return false;\r\n\r\n        return -epsilon < t && t < 1 + epsilon && -epsilon < u && u < 1 + epsilon;\r\n    }\r\n\r\n    intersection(other) {\r\n        const { t, u } = this.intersectionParameters(other);\r\n\r\n        if (t === undefined || u === undefined)\r\n            return undefined;\r\n\r\n        if (t > 1 + epsilon || t < -epsilon || u > 1 + epsilon || u < -epsilon)\r\n            return undefined;\r\n\r\n        return this.offset.scaled(t).added(this.origin);\r\n    }\r\n\r\n    // XXX Document this, stackoverflow link or have a local copy\r\n    intersectionParameters(other) {\r\n        const a = other.origin.subtracted(this.origin);\r\n        const div = this.offset.cross(other.offset);\r\n\r\n        if (almostEquals(div, 0))\r\n            return {};\r\n\r\n        return {\r\n            t: a.cross(other.offset) / div,\r\n            u: a.negated.cross(this.offset) / (-div),\r\n        };\r\n    }\r\n\r\n    containsPoint(p) {\r\n        return almostEquals(p.subtracted(this.origin).cross(this.offset), 0) &&\r\n               valueIsBetween({ value: p.x, limits: [this.origin.x, this.end.x] }) &&\r\n               valueIsBetween({ value: p.y, limits: [this.origin.y, this.end.y] });\r\n    }\r\n\r\n    closestPoint(point) {\r\n        // XXX This also isn't quite right.\r\n        // The line is treated as if it was infinite rather than a line segment.\r\n        if (this.offset.x === 0) {\r\n            return new Vector(this.origin.x, point.y);\r\n        }\r\n\r\n        if (this.offset.y === 0) {\r\n            return new Vector(point.x, this.origin.y);\r\n        }\r\n\r\n        const t = this.offset.dot(point);\r\n        const y = (t * this.offset.y + this.offset.x * this.offset.cross(this.origin)) / this.offset.magnitudeSquared;\r\n        return new Vector((t - y * this.offset.y) / this.offset.x, y);\r\n    }\r\n\r\n    distance(point) {\r\n        return Math.sqrt(this.distanceSquared(point));\r\n    }\r\n\r\n    distanceSquared(point) {\r\n        return this.closestPoint(point).distanceSquared(point);\r\n    }\r\n\r\n    get opposite() {\r\n        return new Line({ origin: this.origin, offset: this.offset.negated });\r\n    }\r\n\r\n    get end() {\r\n        return this.origin.added(this.offset);\r\n    }\r\n\r\n    set end(value) {\r\n        this.offset = value.subtracted(this.origin);\r\n    }\r\n\r\n    get length() {\r\n        return Math.sqrt(this.lengthSquared);\r\n    }\r\n\r\n    get lengthSquared() {\r\n        return this.offset.x * this.offset.x + this.offset.y * this.offset.y;\r\n    }\r\n}\r\n","import { clearContext, drawCircle, drawLine, drawPolygon } from '../../graphics';\r\nimport Line from '../../Line';\r\n\r\nconst visualForceScale = 100000;\r\n\r\nconst backgroundStyle = 'white';\r\n\r\nconst particleColor = {\r\n    hue: 225,\r\n    saturation: 70,\r\n    lightness: 40,\r\n};\r\n\r\nconst maxColorHue = 360;\r\n\r\nconst springStyle = 'grey';\r\n\r\nconst terrainStyle = 'rgb(155, 200, 200)';\r\n\r\nconst forceStyle = 'pink';\r\n\r\n// XXX Have a base class for drawing\r\n\r\nexport default class MassAggregateDrawing {\r\n    constructor({\r\n        context,\r\n        drawingForces = false,\r\n        drawingTerrain = true,\r\n        drawingSprings = true,\r\n        drawingParticles = true\r\n    } = {}) {\r\n        this.context = context;\r\n        this.drawingForces = drawingForces;\r\n        this.drawingTerrain = drawingTerrain;\r\n        this.drawingSprings = drawingSprings;\r\n        this.drawingParticles = drawingParticles;\r\n    }\r\n\r\n    redraw(engine) {\r\n        if (!this.context)\r\n            return;\r\n\r\n        this.clear();\r\n        this.drawTerrain(engine.terrain);\r\n        this.drawParticles(engine.particles);\r\n        this.drawSprings(engine.springs);\r\n        this.drawForces(engine.particles);\r\n    }\r\n\r\n    clear() {\r\n        clearContext(this.context, backgroundStyle);\r\n    }\r\n\r\n    drawTerrain(terrain) {\r\n        if (!this.drawingTerrain)\r\n            return;\r\n\r\n        for (const { polygon } of terrain)\r\n            drawPolygon(this.context, polygon, terrainStyle);\r\n    }\r\n\r\n    drawForces(particles) {\r\n        if (!this.drawingForces)\r\n            return;\r\n\r\n        for (const particle of particles) {\r\n            drawLine(\r\n                this.context,\r\n                new Line(particle.position, particle.force.scaled(visualForceScale)),\r\n                forceStyle,\r\n            );\r\n        }\r\n    }\r\n\r\n    drawParticles(particles) {\r\n        if (!this.drawingParticles || particles.length === 0)\r\n            return;\r\n\r\n        let currentHue = particleColor.hue;\r\n        const hueStep = Math.min(\r\n            (maxColorHue - particleColor.hue) / particles.length,\r\n            20,\r\n        );\r\n\r\n        for (const particle of particles) {\r\n            const style = `hsl(${currentHue}, ${particleColor.saturation}%, ${particleColor.lightness}%)`;\r\n            drawCircle(this.context, { position: particle.position, radius: particle.radius }, style);\r\n            currentHue -= hueStep;\r\n        }\r\n    }\r\n\r\n    drawSprings(springs) {\r\n        if (!this.drawingSprings)\r\n            return;\r\n\r\n        for (const spring of springs)\r\n            drawLine(this.context, spring.line, springStyle);\r\n    }\r\n}\r\n","<template>\r\n  <table>\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <InteractiveSimulationDisplay :simulation=\"simulation\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <RestartButton @click=\"restartEngine\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <GravitySlider :engine=\"simulation.engine\" />\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\nimport Demo from '../Demo';\r\nimport GravitySlider from '../GravitySlider';\r\nimport RestartButton from '../RestartButton';\r\nimport InteractiveSimulationDisplay from '../InteractiveSimulationDisplay';\r\nimport Particle from '../../engine/mass-aggregate/Particle';\r\nimport MassAggregateEngine from '../../engine/mass-aggregate/MassAggregateEngine';\r\nimport MassAggregateDrawing from '../../engine/mass-aggregate/MassAggregateDrawing';\r\nimport Vector from '../../Vector';\r\n\r\nexport default {\r\n    components: {\r\n        InteractiveSimulationDisplay,\r\n        RestartButton,\r\n        GravitySlider,\r\n    },\r\n    mixins: [Demo],\r\n    methods: {\r\n        createEngine(previousEngine) {\r\n            return new MassAggregateEngine({\r\n                gravity: previousEngine.gravity,\r\n                damping: 0,\r\n                particles: [\r\n                    new Particle({\r\n                        position: new Vector(0, 0),\r\n                    }),\r\n                ],\r\n            });\r\n        },\r\n        createDrawing() {\r\n            return new MassAggregateDrawing();\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleDemo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleDemo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParticleDemo.vue?vue&type=template&id=f204f8a6&\"\nimport script from \"./ParticleDemo.vue?vue&type=script&lang=js&\"\nexport * from \"./ParticleDemo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"ParticleDemo.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tr',[_c('td',[_c('InteractiveSimulationDisplay',{attrs:{\"simulation\":_vm.simulation}})],1)]),_c('tr',[_c('td',[_c('RestartButton',{on:{\"click\":_vm.restartEngine}})],1)]),_c('tr',[_c('td',[_c('StiffnessSlider',{model:{value:(_vm.stiffness),callback:function ($$v) {_vm.stiffness=$$v},expression:\"stiffness\"}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"stiffness-slider\"}},[_vm._v(\"\\n    Stiffness\\n  \")]),_c('input',{attrs:{\"id\":\"stiffness-slider\",\"type\":\"range\",\"min\":\"1e-6\",\"max\":\"1e-4\",\"step\":\"1e-9\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('input', Number($event.target.value))}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <label for=\"stiffness-slider\">\r\n      Stiffness\r\n    </label>\r\n    <input\r\n      id=\"stiffness-slider\"\r\n      :value=\"value\"\r\n      type=\"range\"\r\n      min=\"1e-6\"\r\n      max=\"1e-4\"\r\n      step=\"1e-9\"\r\n      @input=\"$emit('input', Number($event.target.value))\"\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        value: Number,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StiffnessSlider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StiffnessSlider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StiffnessSlider.vue?vue&type=template&id=ebf97798&\"\nimport script from \"./StiffnessSlider.vue?vue&type=script&lang=js&\"\nexport * from \"./StiffnessSlider.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"StiffnessSlider.vue\"\nexport default component.exports","import Line from '../../Line';\r\n\r\nexport default class Spring {\r\n    constructor({ particles, stiffness }) {\r\n        this.particles = particles;\r\n        this.stiffness = stiffness;\r\n        this.restingLength = this.currentLength;\r\n    }\r\n\r\n    update() {\r\n        this.contract(this.particles[0], this.particles[1]);\r\n        this.contract(this.particles[1], this.particles[0]);\r\n    }\r\n\r\n    contract(fromParticle, toParticle) {\r\n        const direction = fromParticle.position.direction(toParticle.position);\r\n        fromParticle.force.add(direction.scaled(this.contractionMagnitude));\r\n    }\r\n\r\n    get contractionMagnitude() {\r\n        return this.stiffness * this.lengthDelta;\r\n    }\r\n\r\n    get line() {\r\n        return new Line({\r\n            origin: this.particles[0].position,\r\n            end: this.particles[1].position,\r\n        });\r\n    }\r\n\r\n    get currentLength() {\r\n        return this.particles[0].position.distance(this.particles[1].position);\r\n    }\r\n\r\n    get lengthDelta() {\r\n        return this.currentLength - this.restingLength;\r\n    }\r\n}\r\n","<template>\r\n  <table>\r\n    <tr>\r\n      <td>\r\n        <InteractiveSimulationDisplay :simulation=\"simulation\" />\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <RestartButton @click=\"restartEngine\" />\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <StiffnessSlider v-model=\"stiffness\" />\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\n\r\nimport Demo from '../Demo';\r\nimport InteractiveSimulationDisplay from '../InteractiveSimulationDisplay';\r\nimport RestartButton from '../RestartButton';\r\nimport StiffnessSlider from '../StiffnessSlider';\r\nimport MassAggregateEngine from '../../engine/mass-aggregate/MassAggregateEngine';\r\nimport MassAggregateDrawing from '../../engine/mass-aggregate/MassAggregateDrawing';\r\nimport Spring from '../../engine/mass-aggregate/Spring';\r\nimport Particle from '../../engine/mass-aggregate/Particle';\r\nimport Vector from '../../Vector';\r\n\r\nexport default {\r\n    components: {\r\n        InteractiveSimulationDisplay,\r\n        RestartButton,\r\n        StiffnessSlider,\r\n    },\r\n    mixins: [Demo],\r\n    data() {\r\n        return {\r\n            stiffness: 1e-5,\r\n        };\r\n    },\r\n    watch: {\r\n        stiffness(newStiffness) {\r\n            this.simulation.engine.springs[0].stiffness = newStiffness;\r\n        },\r\n    },\r\n    methods: {\r\n        createEngine(previousEngine) {\r\n            const particles = [\r\n                new Particle({\r\n                    position: Vector.zero,\r\n                    mass: 1,\r\n                    fixed: true,\r\n                }),\r\n                new Particle({\r\n                    position: new Vector(-0.2, 0.2),\r\n                    gravityScale: 2.5,\r\n                    mass: 1,\r\n                }),\r\n            ];\r\n            return new MassAggregateEngine({\r\n                gravity: previousEngine.gravity,\r\n                damping: previousEngine.damping,\r\n                particles,\r\n                springs: [\r\n                    new Spring({ particles, stiffness: this.stiffness }),\r\n                ],\r\n            });\r\n        },\r\n        createDrawing() {\r\n            return new MassAggregateDrawing();\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpringDemo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpringDemo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpringDemo.vue?vue&type=template&id=47609f19&\"\nimport script from \"./SpringDemo.vue?vue&type=script&lang=js&\"\nexport * from \"./SpringDemo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"SpringDemo.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tbody',[_c('tr',[_c('td',[_c('InteractiveSimulationDisplay',{attrs:{\"simulation\":_vm.simulation}})],1)]),_c('tr',[_c('td',[_c('RestartButton',{on:{\"click\":_vm.restartEngine}})],1)]),_c('tr',[_c('td',[_c('RestitutionSlider',{attrs:{\"terrainElement\":_vm.platform}})],1)]),_c('tr',[_c('td',[_c('AngleSlider',{model:{value:(_vm.platformAngle),callback:function ($$v) {_vm.platformAngle=$$v},expression:\"platformAngle\"}})],1)]),_c('tr',[_c('td',[_c('LengthSlider',{model:{value:(_vm.platformLength),callback:function ($$v) {_vm.platformLength=$$v},expression:\"platformLength\"}})],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"restitution-slider\"}},[_vm._v(\"\\n    Restitution\\n  \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.terrainElement.restitution),expression:\"terrainElement.restitution\",modifiers:{\"number\":true}}],attrs:{\"id\":\"restitution-slider\",\"type\":\"range\",\"min\":\"0\",\"max\":\"0.9\",\"step\":\"1e-9\"},domProps:{\"value\":(_vm.terrainElement.restitution)},on:{\"__r\":function($event){_vm.$set(_vm.terrainElement, \"restitution\", _vm._n($event.target.value))},\"blur\":function($event){_vm.$forceUpdate()}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <label for=\"restitution-slider\">\r\n      Restitution\r\n    </label>\r\n    <input\r\n      id=\"restitution-slider\"\r\n      v-model.number=\"terrainElement.restitution\"\r\n      type=\"range\"\r\n      min=\"0\"\r\n      max=\"0.9\"\r\n      step=\"1e-9\"\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        terrainElement: Object,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RestitutionSlider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RestitutionSlider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RestitutionSlider.vue?vue&type=template&id=b516d652&\"\nimport script from \"./RestitutionSlider.vue?vue&type=script&lang=js&\"\nexport * from \"./RestitutionSlider.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"RestitutionSlider.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"angle-slider\"}},[_vm._v(\"\\n    Angle\\n  \")]),_c('input',{attrs:{\"id\":\"angle-slider\",\"type\":\"range\",\"min\":\"-1.57\",\"max\":\"1.57\",\"step\":\"1e-9\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('input', Number($event.target.value))}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <label for=\"angle-slider\">\r\n      Angle\r\n    </label>\r\n    <input\r\n      id=\"angle-slider\"\r\n      type=\"range\"\r\n      min=\"-1.57\"\r\n      max=\"1.57\"\r\n      step=\"1e-9\"\r\n      :value=\"value\"\r\n      @input=\"$emit('input', Number($event.target.value))\"\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        value: Number,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AngleSlider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AngleSlider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AngleSlider.vue?vue&type=template&id=d568e0de&\"\nimport script from \"./AngleSlider.vue?vue&type=script&lang=js&\"\nexport * from \"./AngleSlider.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"AngleSlider.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"length-slider\"}},[_vm._v(\"\\n    Length\\n  \")]),_c('input',{attrs:{\"id\":\"length-slider\",\"type\":\"range\",\"min\":\"0.2\",\"max\":\"4\",\"step\":\"1e-9\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('input', Number($event.target.value))}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <label for=\"length-slider\">\r\n      Length\r\n    </label>\r\n    <input\r\n      id=\"length-slider\"\r\n      type=\"range\"\r\n      :value=\"value\"\r\n      min=\"0.2\"\r\n      max=\"4\"\r\n      step=\"1e-9\"\r\n      @input=\"$emit('input', Number($event.target.value))\"\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        value: Number,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LengthSlider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LengthSlider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LengthSlider.vue?vue&type=template&id=20570698&\"\nimport script from \"./LengthSlider.vue?vue&type=script&lang=js&\"\nexport * from \"./LengthSlider.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"LengthSlider.vue\"\nexport default component.exports","import { min } from './utils';\r\nimport Line from './Line';\r\nimport Vector from './Vector';\r\n\r\nfunction * edges(vertices) {\r\n    for (let i = 0; i < vertices.length - 1; ++i) {\r\n        yield new Line({\r\n            origin: vertices[i].cloned,\r\n            end: vertices[i + 1].cloned,\r\n        });\r\n    }\r\n\r\n    yield new Line({\r\n        origin: vertices[vertices.length - 1].cloned,\r\n        end: vertices[0].cloned,\r\n    });\r\n}\r\n\r\nexport default class Polygon {\r\n    static fromVertices(vertices) {\r\n        if (vertices.length < 3)\r\n            throw new Error('Polygon must have at least three vertices');\r\n        return Polygon.fromEdges(Array.from(edges(vertices)));\r\n    }\r\n\r\n    static fromEdges(edges) {\r\n        if (edges.length < 3)\r\n            throw new Error('Polygon must have at least three edges');\r\n        return new Polygon(edges);\r\n    }\r\n\r\n    constructor(edges) {\r\n        this.edges = edges;\r\n    }\r\n\r\n    edgesAreConnected() {\r\n        for (let i = 1; i < this.edges.length; ++i) {\r\n            if (!this.edges[i].origin.almostEquals(this.edges[i - 1].end))\r\n                return false;\r\n        }\r\n\r\n        if (!this.edges[0].origin.almostEquals(this.edges[this.edges.length - 1].end))\r\n            return false;\r\n\r\n        return true;\r\n    }\r\n\r\n    // If point is on a vertex or on an edge, this method returns false.\r\n    containsPoint(point) {\r\n        const ray = new Line({ origin: point, offset: new Vector(1, 0) });\r\n        return this.countIntersections(ray) % 2 === 1;\r\n    }\r\n\r\n    countIntersections(ray) {\r\n        return this.edges.reduce((acc, edge) => {\r\n            if (edge.containsPoint(ray.origin))\r\n                return acc;\r\n            if (ray.rayIntersects(edge))\r\n                return acc + 1;\r\n            return acc;\r\n        }, 0);\r\n    }\r\n\r\n    closestEdge(point) {\r\n        return min(this.edges, edge => edge.distance(point));\r\n    }\r\n}\r\n","export default class TerrainElement {\r\n    constructor({ polygon, restitution, friction }) {\r\n        this.polygon = polygon;\r\n        this.restitution = restitution;\r\n        this.friction = friction;\r\n    }\r\n}\r\n","<template>\r\n  <table>\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <InteractiveSimulationDisplay :simulation=\"simulation\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <RestartButton @click=\"restartEngine\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <RestitutionSlider :terrainElement=\"platform\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <AngleSlider v-model=\"platformAngle\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <LengthSlider v-model=\"platformLength\" />\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\nimport Demo from '../Demo';\r\nimport InteractiveSimulationDisplay from '../InteractiveSimulationDisplay';\r\nimport RestartButton from '../RestartButton';\r\nimport RestitutionSlider from '../RestitutionSlider';\r\nimport AngleSlider from '../AngleSlider';\r\nimport LengthSlider from '../LengthSlider';\r\nimport Polygon from '../../Polygon';\r\nimport Vector from '../../Vector';\r\nimport Particle from '../../engine/mass-aggregate/Particle';\r\nimport MassAggregateEngine from '../../engine/mass-aggregate/MassAggregateEngine';\r\nimport MassAggregateDrawing from '../../engine/mass-aggregate/MassAggregateDrawing';\r\nimport TerrainElement from '../../engine/mass-aggregate/TerrainElement';\r\n\r\n// XXX Add a friction slider here and see if you can figure out a decent default value\r\n\r\nfunction startingPosition() {\r\n    return new Vector(0, 0.9);\r\n}\r\n\r\nexport default {\r\n    components: { InteractiveSimulationDisplay, RestartButton, RestitutionSlider, AngleSlider, LengthSlider },\r\n    mixins: [Demo],\r\n    data() {\r\n        const platformRestitution = 0.45;\r\n\r\n        return {\r\n            particle: new Particle({ position: startingPosition, mass: 1 }),\r\n            platform: new TerrainElement({\r\n                polygon: Polygon.fromVertices([\r\n                    new Vector(-0.5, 0), new Vector(0.5, 0),\r\n                    new Vector(0.5, -2), new Vector(-0.5, -2),\r\n                ]),\r\n                restitution: platformRestitution,\r\n                friction: 1e-2,\r\n            }),\r\n            platformAngle: 0,\r\n            platformLength: 1,\r\n            platformRestitution,\r\n        };\r\n    },\r\n    watch: {\r\n        platformAngle() {\r\n            this.updatePlatformLayout();\r\n        },\r\n        platformLength() {\r\n            this.updatePlatformLayout();\r\n        },\r\n        platformRestitution() {\r\n            for (const terrainElement of this.simulation.engine.terrain)\r\n                terrainElement.restitution = this.platformRestitution;\r\n        },\r\n    },\r\n    methods: {\r\n        createEngine(previousEngine) {\r\n            this.particle.position = startingPosition();\r\n            this.particle.velocity = Vector.zero;\r\n\r\n            return new MassAggregateEngine({\r\n                gravity: previousEngine.gravity,\r\n                damping: previousEngine.damping,\r\n                particles: [this.particle],\r\n                terrain: [this.platform, new TerrainElement({\r\n                    restitution: this.platformRestitution,\r\n                    polygon: Polygon.fromVertices([\r\n                        new Vector(0.8, 0.8), new Vector(4, 0.8),\r\n                        new Vector(4, -0.8), new Vector(0.8, -0.8),\r\n                    ]),\r\n                })],\r\n            });\r\n        },\r\n        createDrawing() {\r\n            return new MassAggregateDrawing();\r\n        },\r\n        updatePlatformLayout() {\r\n            const lengthHalf = this.platformLength / 2;\r\n            const x = lengthHalf * Math.cos(this.platformAngle);\r\n            const y = lengthHalf * Math.sin(this.platformAngle);\r\n            this.platform.polygon = Polygon.fromVertices([\r\n                new Vector(-x, -y), new Vector(x, y),\r\n                new Vector(x, -2), new Vector(-x, -2),\r\n            ]);\r\n            this.simulation.engine.terrain[0].polygon = this.platform.polygon;\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TerrainDemo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TerrainDemo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TerrainDemo.vue?vue&type=template&id=da9b0c44&\"\nimport script from \"./TerrainDemo.vue?vue&type=script&lang=js&\"\nexport * from \"./TerrainDemo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"TerrainDemo.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tbody',[_c('tr',[_c('td',[_c('InteractiveSimulationDisplay',{attrs:{\"simulation\":_vm.simulation}})],1)]),_c('tr',[_c('td',[_c('RestartButton',{on:{\"click\":_vm.restartEngine}})],1)]),_c('tr',[_c('td',[_c('label',[_vm._v(\"Force\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.firingForce),expression:\"firingForce\"}],attrs:{\"type\":\"range\",\"min\":\"1e-4\",\"max\":\"4e-3\",\"step\":\"1e-9\"},domProps:{\"value\":(_vm.firingForce)},on:{\"__r\":function($event){_vm.firingForce=$event.target.value}}})])]),_c('tr',[_c('td',[_c('ParticleMassSliders',{attrs:{\"particles\":_vm.particles,\"min\":1,\"max\":5}})],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tbody',_vm._l((_vm.particles),function(particle,index){return _c('tr',{key:index},[_c('label',{attrs:{\"for\":'mass-input' + index}},[_vm._v(\"\\n        Particle \"+_vm._s(index)+\" mass\\n      \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(particle.mass),expression:\"particle.mass\",modifiers:{\"number\":true}}],attrs:{\"id\":'mass-input' + index,\"type\":\"range\",\"min\":_vm.min,\"max\":_vm.max,\"step\":\"1e-9\"},domProps:{\"value\":(particle.mass)},on:{\"__r\":function($event){_vm.$set(particle, \"mass\", _vm._n($event.target.value))},\"blur\":function($event){_vm.$forceUpdate()}}})])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <table>\r\n    <tbody>\r\n      <tr\r\n        v-for=\"(particle, index) in particles\"\r\n        :key=\"index\"\r\n      >\r\n        <label :for=\"'mass-input' + index\">\r\n          Particle {{ index }} mass\r\n        </label>\r\n        <input\r\n          :id=\"'mass-input' + index\"\r\n          v-model.number=\"particle.mass\"\r\n          type=\"range\"\r\n          :min=\"min\"\r\n          :max=\"max\"\r\n          step=\"1e-9\"\r\n        >\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        particles: Array,\r\n        min: Number,\r\n        max: Number,\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleMassSliders.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleMassSliders.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParticleMassSliders.vue?vue&type=template&id=1055ef77&\"\nimport script from \"./ParticleMassSliders.vue?vue&type=script&lang=js&\"\nexport * from \"./ParticleMassSliders.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"ParticleMassSliders.vue\"\nexport default component.exports","<template>\r\n  <table>\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <InteractiveSimulationDisplay :simulation=\"simulation\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <RestartButton @click=\"restartEngine\" />\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <label>Force</label>\r\n          <input\r\n            v-model=\"firingForce\"\r\n            type=\"range\"\r\n            min=\"1e-4\"\r\n            max=\"4e-3\"\r\n            step=\"1e-9\"\r\n          >\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          <ParticleMassSliders\r\n            :particles=\"particles\"\r\n            :min=\"1\"\r\n            :max=\"5\"\r\n          />\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\nimport Demo from '../Demo';\r\nimport InteractiveSimulationDisplay from '../InteractiveSimulationDisplay';\r\nimport RestartButton from '../RestartButton';\r\nimport ParticleMassSliders from '../ParticleMassSliders';\r\nimport MassAggregateEngine from '../../engine/mass-aggregate/MassAggregateEngine';\r\nimport MassAggregateDrawing from '../../engine/mass-aggregate/MassAggregateDrawing';\r\nimport Particle from '../../engine/mass-aggregate/Particle';\r\nimport Vector from '../../Vector';\r\n\r\nconst leftParticlePosition = new Vector(-0.5, 0);\r\n\r\nconst rightParticlePosition = new Vector(0.5, 0);\r\n\r\nclass FiredParticle extends Particle {\r\n    constructor({ firingForce, ...params }) {\r\n        super(params);\r\n        this.firingForce = firingForce;\r\n        this.fired = false;\r\n    }\r\n\r\n    updateVelocity(timestep) {\r\n        if (!this.fired) {\r\n            this.fired = true;\r\n            this.force.add(this.firingForce);\r\n        }\r\n\r\n        super.updateVelocity(timestep);\r\n    }\r\n}\r\n\r\nexport default {\r\n    components: { InteractiveSimulationDisplay, RestartButton, ParticleMassSliders },\r\n    mixins: [Demo],\r\n    data() {\r\n        const firingForce = 8.3e-4;\r\n\r\n        return {\r\n            firingForce,\r\n            particles: [\r\n                new FiredParticle({\r\n                    position: leftParticlePosition.cloned,\r\n                    mass: 1,\r\n                    firingForce: new Vector(firingForce, 0),\r\n                }),\r\n                new FiredParticle({\r\n                    position: rightParticlePosition.cloned,\r\n                    mass: 1,\r\n                    firingForce: new Vector(-firingForce, 0),\r\n                }),\r\n            ],\r\n        };\r\n    },\r\n    methods: {\r\n        createEngine() {\r\n            this.particles[0].position = leftParticlePosition.cloned;\r\n            this.particles[0].velocity = Vector.zero;\r\n            this.particles[0].fired = false;\r\n            this.particles[0].firingForce = new Vector(this.firingForce, 0);\r\n            this.particles[1].position = rightParticlePosition.cloned;\r\n            this.particles[1].velocity = Vector.zero;\r\n            this.particles[1].fired = false;\r\n            this.particles[1].firingForce = new Vector(-this.firingForce, 0);\r\n\r\n            return new MassAggregateEngine({\r\n                gravity: 0,\r\n                particles: this.particles,\r\n            });\r\n        },\r\n        createDrawing() {\r\n            return new MassAggregateDrawing();\r\n        },\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleCollisionDemo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticleCollisionDemo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParticleCollisionDemo.vue?vue&type=template&id=a59cdcce&\"\nimport script from \"./ParticleCollisionDemo.vue?vue&type=script&lang=js&\"\nexport * from \"./ParticleCollisionDemo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"ParticleCollisionDemo.vue\"\nexport default component.exports","<template>\r\n  <div>\r\n    <select v-model=\"currentDemo\">\r\n      <option\r\n        v-for=\"demo in demos\"\r\n        :key=\"demo.title\"\r\n        :value=\"demo.component\"\r\n      >\r\n        {{ demo.title }}\r\n      </option>\r\n    </select>\r\n\r\n    <component :is=\"currentDemo\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ParticleDemo from './mass-aggregate/ParticleDemo';\r\nimport SpringDemo from './mass-aggregate/SpringDemo';\r\nimport TerrainDemo from './mass-aggregate/TerrainDemo';\r\nimport ParticleCollisionDemo from './mass-aggregate/ParticleCollisionDemo';\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            demos: [\r\n                {\r\n                    title: 'Particle Demo',\r\n                    component: ParticleDemo,\r\n                },\r\n                {\r\n                    title: 'Spring Demo',\r\n                    component: SpringDemo,\r\n                },\r\n                {\r\n                    title: 'Terrain Demo',\r\n                    component: TerrainDemo,\r\n                },\r\n                {\r\n                    title: 'Particle Collision Demo',\r\n                    component: ParticleCollisionDemo,\r\n                },\r\n            ],\r\n            currentDemo: undefined,\r\n        };\r\n    },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DemoChoice.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DemoChoice.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DemoChoice.vue?vue&type=template&id=693e95c4&\"\nimport script from \"./DemoChoice.vue?vue&type=script&lang=js&\"\nexport * from \"./DemoChoice.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"DemoChoice.vue\"\nexport default component.exports","<template>\r\n  <DemoChoice />\r\n</template>\r\n\r\n<script>\r\nimport DemoChoice from './components/DemoChoice';\r\n\r\n// XXX Pass the line tests\r\n\r\nexport default {\r\n    components: { DemoChoice },\r\n};\r\n</script>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2a6adcc9&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","import Vue from 'vue';\r\nimport App from './App.vue';\r\n\r\nVue.config.productionTip = false;\r\n\r\nnew Vue({\r\n    el: '#app',\r\n    render: h => h(App),\r\n});\r\n"],"sourceRoot":""}